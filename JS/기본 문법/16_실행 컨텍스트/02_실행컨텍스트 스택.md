```js
const x = 1

function foo(a){
   const y = 2
   function bar(){
      const z = 3
      console.log(x + y + z)
   }
   bar()
}
foo()

```

실행컨텍스트 스택

1. 

   전역 실행 컨텍스트

2. 

   foo 함수 실행 컨텍스트

   전역 실행 컨텍스트

3. 

   bar함수 실행 컨텍스트

   foo함수 실행 컨텍스트

   전역 실행 컨텍스트

4. 

   foo 함수 실행 컨텍스트

   전역 실행 컨텍스트

5.

​	전역 실행 컨텍스트



### 1. 전역 코드의 평가와 실행

JS엔진은 먼저 전역 코드를 평가하여 전역 실행 컨텍스트를 생성하고 실행 컨텍스트 스택에 푸쉬한다. 전역 변수 x와 전역 함수foo는 전역 실행 컨텍스트에 등록된다. 이후 전역 코드가 실행되기 시작하여 전역 변수 x에 값이 할당되고 전역 함수 foo가 호출된다.

### 2. foo 함수 코드의 평가와 실행

전역 함수 foo가 호출되면 전역 코드의 실행은 일시 중단되고 코드의 제어권이 foo함수 내부로 이동한다.

JS엔진은 foo함수 내부의 함수 코드를 평가하여 foo함수 실행 컨텍스트를 생성하고 실행 컨텍스트 스택에 푸시한다.이때 foo함수의 지역변수 y와 중첩함수bar가 foo함수 실행 컨텍스트에 등록된다. 이후 foo함수 코드가 실행되기 시작하여 지역변수 y에 값이 할당되고 중첩함수bar가 호출된다.



### 3. bar함수 코드의 평가와 실행

충첩함수 bar가 호출되면 foo함수 코드의 실행은 일시 중단되고 코드의 제어권이bar함수 내부로 이동한다. JS엔진은 bar함수 내부의 함수코드를 평가하여 bar함수 실행 컨텍스트를 생성하고실행 컨텍스트 스택에 푸시한다.

### 4. foo함수 코드로 복귀

bar함수가 종료되면 코드의 제어권은 다시 foo함수로 이동한다. 이때 JS엔진은 bar함수 실행 컨텍스트를 실행 컨텍스트 스택에서 팝하여 제거한다. 그리고 foo함수는 더 이상 실행할 코드가 없으므로 종료된다.

### 5.전역 코드로 복귀

foo함수가 종료되면 코드의 제어권은 다시 전역 코드로 이동한다. 이때 JS엔진은 foo함수 실행 컨텍스트를 실행컨텍스트 스택에서 팝하여 제거한다. 다음으로 실행할 전역 코드가 남아 있지 않으므로 전역 실행 컨텍스트도 스택에서 팝하여 제거된다..



이처럼 실행컨텍스트 스택은 코드의 실행 순서를 관리한다. 소스코드가 평가되면 실행 컨텍스트가 생성되고 실행 컨텍스트 스택의 최상위에 쌓인다. 실행 컨텍스트스택의 최상위에 존재하는 실행 컨텍스트는 언제나 현재 실행중인 코드의 실행 컨텍스트이다. 따라서 실행 컨텍스트 스택의 최상위에 존재하는 실행 컨텍스트를 실행중인 실행 컨텍스트라 부른다.

